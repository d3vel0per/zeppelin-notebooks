{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573546729326_-1799830221","id":"20191112-081849_883604211","dateCreated":"2019-11-12T08:18:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:18188","text":"%sh\n# Checking environment variables\necho \"JAVA_HOME: $JAVA_HOME\"\necho \"SPARK_HOME: $SPARK_HOME\"\necho \"HADOOP_CONF_DIR: $HADOOP_CONF_DIR\"\necho \"PYTHON_HOME: $PYTHON_HOME\"","dateUpdated":"2019-11-12T08:31:47+0000","dateFinished":"2019-11-12T08:31:47+0000","dateStarted":"2019-11-12T08:31:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"JAVA_HOME: /usr/lib/jvm/java-8-openjdk-amd64\nSPARK_HOME: \nHADOOP_CONF_DIR: \nPYTHON_HOME: \n"}]}},{"text":"%python\n\n#Generate random data\nimport random\n\naccount_list = ['A01','A02','A03','A04','A05','A06','A07','A08','A09','A10','A11','A12','A13','A14','A15','A16','A17','A18','A19','A20']\ncusip_list = ['C01','C02','C03','C04','C05','C06','C07','C08','C09','C10','C11','C12','C13','C14','C15','C16','C17','C18','C19','C20']\ncr_db_ind = ['CR','DB']\nfile_prefix = \"/notebook/data/billing/file_\"\n\nfor i in range(0,10):\n    f = open(\"{}{}\".format(file_prefix,i),\"w\")\n    f.write(\"ACCOUNT,CUSIP,CR_DB_IND,AMOUNT\\n\")\n    for j in range(0,100):\n        f.write(\"{},{},{},{}\\n\".format(random.choice(account_list), random.choice(cusip_list), random.choice(cr_db_ind), random.randint(1,1000)))\n    f.close()","user":"anonymous","dateUpdated":"2019-11-12T08:48:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573547507399_1731764960","id":"20191112-083147_276161356","dateCreated":"2019-11-12T08:31:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19229","dateFinished":"2019-11-12T08:48:17+0000","dateStarted":"2019-11-12T08:48:17+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n\n# create DataFrame from python list. It can infer schema for you.\ndf1 = spark.createDataFrame([(1, \"andy\", 20, \"USA\"), (2, \"jeff\", 23, \"China\"), (3, \"james\", 18, \"USA\")]).toDF(\"id\", \"name\", \"age\", \"country\")\ndf1.printSchema\ndf1.show()\n\n# create DataFrame from pandas dataframe\ndf2 = spark.createDataFrame(df1.toPandas())\ndf2.printSchema\ndf2.show()\n","user":"anonymous","dateUpdated":"2019-11-12T08:54:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573548349800_179283637","id":"20191112-084549_2022044833","dateCreated":"2019-11-12T08:45:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19324","dateFinished":"2019-11-12T08:54:47+0000","dateStarted":"2019-11-12T08:54:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+-----+---+-------+\n| id| name|age|country|\n+---+-----+---+-------+\n|  1| andy| 20|    USA|\n|  2| jeff| 23|  China|\n|  3|james| 18|    USA|\n+---+-----+---+-------+\n\n+---+-----+---+-------+\n| id| name|age|country|\n+---+-----+---+-------+\n|  1| andy| 20|    USA|\n|  2| jeff| 23|  China|\n|  3|james| 18|    USA|\n+---+-----+---+-------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.4:4040/jobs/job?id=1","http://172.17.0.4:4040/jobs/job?id=2","http://172.17.0.4:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nrc = spark.read.csv(\"/notebook/data/billing/file_*\", header=True)\nrc.show(5)","user":"anonymous","dateUpdated":"2019-11-12T18:20:17+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573548864613_-1430775703","id":"20191112-085424_1236564812","dateCreated":"2019-11-12T08:54:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19470","dateFinished":"2019-11-12T18:20:22+0000","dateStarted":"2019-11-12T18:20:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+---------+------+\n|ACCOUNT|CUSIP|CR_DB_IND|AMOUNT|\n+-------+-----+---------+------+\n|    A13|  C20|       CR|   274|\n|    A17|  C14|       DB|   384|\n|    A17|  C06|       DB|   920|\n|    A03|  C18|       CR|   589|\n|    A13|  C08|       DB|   701|\n+-------+-----+---------+------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.4:4040/jobs/job?id=4","http://172.17.0.4:4040/jobs/job?id=5"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nrc.dtypes\nrc.printSchema()\nrc.columns","user":"anonymous","dateUpdated":"2019-11-12T18:36:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573582804689_-1074033628","id":"20191112-182004_1029578763","dateCreated":"2019-11-12T18:20:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19622","dateFinished":"2019-11-12T18:36:07+0000","dateStarted":"2019-11-12T18:36:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ACCOUNT: string (nullable = true)\n |-- CUSIP: string (nullable = true)\n |-- CR_DB_IND: string (nullable = true)\n |-- AMOUNT: string (nullable = true)\n\n['ACCOUNT', 'CUSIP', 'CR_DB_IND', 'AMOUNT']"}]}},{"text":"%pyspark\nfrom pyspark.sql.types import StructType, StructField, StringType, IntegerType\n\nlabels = [\n    ('ACCOUNT', StringType())\n    ,('CUSIP', StringType())\n    ,('CR_DB_IND', StringType())\n    ,('AMOUNT', IntegerType())\n    ]\n    \nschema = StructType([StructField(x[0], x[1], True) for x in labels])\nschema","user":"anonymous","dateUpdated":"2019-11-12T18:41:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573583807832_-1267809494","id":"20191112-183647_1520494203","dateCreated":"2019-11-12T18:36:47+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19909","dateFinished":"2019-11-12T18:41:55+0000","dateStarted":"2019-11-12T18:41:55+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"StructType(List(StructField(ACCOUNT,StringType,true),StructField(CUSIP,StringType,true),StructField(CR_DB_IND,StringType,true),StructField(AMOUNT,IntegerType,true)))"}]}},{"text":"%pyspark\nrc = spark.read.csv(\"/notebook/data/billing/file_*\", header=True, schema=schema)","user":"anonymous","dateUpdated":"2019-11-12T18:43:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573583196689_-283701786","id":"20191112-182636_1224382367","dateCreated":"2019-11-12T18:26:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19761","dateFinished":"2019-11-12T18:43:04+0000","dateStarted":"2019-11-12T18:43:04+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nrc.printSchema()","user":"anonymous","dateUpdated":"2019-11-12T18:43:16+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573584184042_-409035335","id":"20191112-184304_1871180591","dateCreated":"2019-11-12T18:43:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20008","dateFinished":"2019-11-12T18:43:16+0000","dateStarted":"2019-11-12T18:43:16+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- ACCOUNT: string (nullable = true)\n |-- CUSIP: string (nullable = true)\n |-- CR_DB_IND: string (nullable = true)\n |-- AMOUNT: integer (nullable = true)\n\n"}]}},{"text":"%pyspark\nrc.show(5)","user":"anonymous","dateUpdated":"2019-11-12T18:44:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573584196197_248257392","id":"20191112-184316_1495911067","dateCreated":"2019-11-12T18:43:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20089","dateFinished":"2019-11-12T18:44:21+0000","dateStarted":"2019-11-12T18:44:20+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+---------+------+\n|ACCOUNT|CUSIP|CR_DB_IND|AMOUNT|\n+-------+-----+---------+------+\n|    A13|  C20|       CR|   274|\n|    A17|  C14|       DB|   384|\n|    A17|  C06|       DB|   920|\n|    A03|  C18|       CR|   589|\n|    A13|  C08|       DB|   701|\n+-------+-----+---------+------+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.4:4040/jobs/job?id=6"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nrc.select('ACCOUNT','CUSIP').show(5)","user":"anonymous","dateUpdated":"2019-11-12T18:48:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573584260601_-1794018767","id":"20191112-184420_479911426","dateCreated":"2019-11-12T18:44:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20186","dateFinished":"2019-11-12T18:48:05+0000","dateStarted":"2019-11-12T18:48:04+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-----+\n|ACCOUNT|CUSIP|\n+-------+-----+\n|    A13|  C20|\n|    A17|  C14|\n|    A17|  C06|\n|    A03|  C18|\n|    A13|  C08|\n+-------+-----+\nonly showing top 5 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.4:4040/jobs/job?id=8"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\nrc.count()","user":"anonymous","dateUpdated":"2019-11-12T18:52:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573584434932_-845516493","id":"20191112-184714_1158364421","dateCreated":"2019-11-12T18:47:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20299","dateFinished":"2019-11-12T18:52:14+0000","dateStarted":"2019-11-12T18:52:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"1000"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.4:4040/jobs/job?id=9"],"interpreterSettingId":"spark"}}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-11-12T18:52:13+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1573584733305_1303627177","id":"20191112-185213_1018518371","dateCreated":"2019-11-12T18:52:13+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:20453"}],"name":"billing","id":"2ES7288FD","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}